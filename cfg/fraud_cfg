digraph clusterfraud_cfg {
	graph [label=fraud_cfg]
	1 [label="from src.fraud.Transaction import Transaction
from src.fraud.FraudCheckResult import FraudCheckResult
\"\"\"Um sistema para detectar transações potencialmente fraudulentas.\"\"\"
def check_for_fraud(self, current_transaction: Transaction,...
"]
	subgraph clustercheck_for_fraud {
		graph [label=check_for_fraud]
		3 [label="\"\"\"
        Verifica a transação atual contra um conjunto de regras para identificar fraudes.
        \"\"\"
is_fraudulent = False
is_blocked = False
verification_required = False
risk_score = 0
if current_transaction.amount > 10000:
"]
		4 [label="is_fraudulent = True
verification_required = True
risk_score += 50
"]
		5 [label="recent_transaction_count = 0
"]
		6 [label="for transaction in previous_transactions:
"]
		7 [label="time_difference = current_transaction.timestamp - transaction.timestamp
time_diff_minutes = time_difference.total_seconds() / 60
if time_diff_minutes <= 60:
"]
		"7_calls" [label="time_difference.total_seconds" shape=box]
		7 -> "7_calls" [label=calls style=dashed]
		9 [label="recent_transaction_count += 1
"]
		9 -> 6 [label=""]
		7 -> 9 [label="time_diff_minutes <= 60"]
		7 -> 6 [label="(time_diff_minutes > 60)"]
		6 -> 7 [label=previous_transactions]
		8 [label="if recent_transaction_count > 10:
"]
		11 [label="is_blocked = True
risk_score += 30
"]
		12 [label="if previous_transactions:
"]
		13 [label="last_transaction = previous_transactions[-1]
time_since_last = current_transaction.timestamp - last_transaction.timestamp
minutes_since_last = time_since_last.total_seconds() / 60
if minutes_since_last < 30 and last_transaction.location != current_transaction.location:
"]
		"13_calls" [label="time_since_last.total_seconds" shape=box]
		13 -> "13_calls" [label=calls style=dashed]
		15 [label="is_fraudulent = True
verification_required = True
risk_score += 20
"]
		14 [label="if current_transaction.location in blacklisted_locations:
"]
		17 [label="is_blocked = True
risk_score = 100
"]
		18 [label="return FraudCheckResult(is_fraudulent, is_blocked, verification_required,
    risk_score)
"]
		17 -> 18 [label=""]
		14 -> 17 [label="current_transaction.location in blacklisted_locations"]
		14 -> 18 [label="(current_transaction.location not in blacklisted_locations)"]
		15 -> 14 [label=""]
		13 -> 15 [label="minutes_since_last < 30 and last_transaction.location != current_transaction.location"]
		13 -> 14 [label="(not (minutes_since_last < 30 and last_transaction.location !=
    current_transaction.location))"]
		12 -> 13 [label=previous_transactions]
		12 -> 14 [label="(not previous_transactions)"]
		11 -> 12 [label=""]
		8 -> 11 [label="recent_transaction_count > 10"]
		8 -> 12 [label="(recent_transaction_count <= 10)"]
		6 -> 8 [label=""]
		5 -> 6 [label=""]
		4 -> 5 [label=""]
		3 -> 4 [label="current_transaction.amount > 10000"]
		3 -> 5 [label="(current_transaction.amount <= 10000)"]
	}
}
